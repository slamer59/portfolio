---
title: "ArgoCD GitOps Architecture: Multi-Tenant Kubernetes"
slug: "argocd-dagster-gitops-production"
date: "2025-03-20T10:00:00.000Z"
summary: "Build scalable multi-tenant GitOps with ArgoCD and Dagster. Automate Kubernetes deployments, reduce deploy time from 2h to 5min with zero-downtime."
author: "Thomas Pedot"
technologies: ["ArgoCD", "Kubernetes", "Helm", "GitOps", "Git"]
image: "/images/devprojects/argocd-gitops.png"
published: true
featured: true
keywords: ["gitops architecture", "argocd multi-tenant", "kubernetes deployment", "dagster infrastructure", "continuous deployment"]
type: "article"
github: "https://github.com/slamer59/dagster-argocd-configuration"
pillarPage: "cloud-native-devops-expertise"
pillarTitle: "Kubernetes Production & DevOps: Helm, GitOps, ArgoCD"
---

> ðŸ“š Part of the [Cloud Native & DevOps Expertise](/articles/cloud-native-devops-expertise) series

## GitOps : Au-DelÃ  du Buzzword

GitOps n'est pas qu'un terme Ã  la mode. C'est une mÃ©thodologie rÃ©volutionnaire qui transforme la faÃ§on dont nous gÃ©rons l'infrastructure et les dÃ©ploiements.

### DÃ©finition GitOps

1. **Git comme source de vÃ©ritÃ©**
2. **DÃ©ploiement dÃ©claratif**
3. **Synchronisation automatique**
4. **TraÃ§abilitÃ© complÃ¨te**

## Le DÃ©fi : DÃ©ploiements Multi-Tenant

Comment dÃ©ployer et gÃ©rer plusieurs environnements de donnÃ©es (tenants) avec :
- Isolation complÃ¨te
- Configuration dynamique
- ZÃ©ro intervention manuelle
- SÃ©curitÃ© renforcÃ©e

## Notre Architecture

### Structure des Repositories

```
1. argocd-apps/              # ApplicationSets et Apps ArgoCD
   â”œâ”€â”€ applicationset.yaml
   â””â”€â”€ apps/
       â”œâ”€â”€ dagster-tenant-1.yaml
       â”œâ”€â”€ dagster-tenant-2.yaml
       â””â”€â”€ ...

2. helm-charts/              # Charts Helm customs
   â”œâ”€â”€ dagster/
   â”‚   â”œâ”€â”€ Chart.yaml
   â”‚   â”œâ”€â”€ values.yaml
   â”‚   â””â”€â”€ templates/
   â””â”€â”€ monitoring/

3. tenant-configs/           # Configurations par tenant
   â”œâ”€â”€ team-analytics/
   â”‚   â””â”€â”€ values.yaml
   â”œâ”€â”€ team-ml/
   â”‚   â””â”€â”€ values.yaml
   â””â”€â”€ ...
```

### ApplicationSet Multi-Tenant

```yaml
# argocd-apps/applicationset.yaml
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: dagster-tenants
spec:
  generators:
    - git:
        repoURL: https://github.com/slamer59/tenant-configs
        revision: main
        directories:
          - path: '*'  # Un dossier = un tenant

  template:
    metadata:
      name: 'dagster-{{path.basename}}'
    spec:
      project: default
      source:
        repoURL: https://github.com/slamer59/helm-charts
        targetRevision: main
        path: dagster
        helm:
          valueFiles:
            - https://github.com/slamer59/tenant-configs/{{path.basename}}/values.yaml
      destination:
        server: https://kubernetes.default.svc
        namespace: 'dagster-{{path.basename}}'
      syncPolicy:
        automated:
          prune: true
          selfHeal: true
```

## Isolation Multi-Tenant

### Namespace Kubernetes

```yaml
# Namespace dÃ©diÃ©
apiVersion: v1
kind: Namespace
metadata:
  name: dagster-team-sales
  labels:
    tenant: team-sales

---
# Resource Quotas
apiVersion: v1
kind: ResourceQuota
metadata:
  name: tenant-quota
  namespace: dagster-team-sales
spec:
  hard:
    requests.cpu: "10"
    requests.memory: "40Gi"
    persistentvolumeclaims: "10"

---
# Network Policy
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: tenant-isolation
  namespace: dagster-team-sales
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
  ingress:
    - from:
      - podSelector: {}  # Autoriser au sein du namespace
  egress:
    - to:
      - podSelector: {}  # Autoriser au sein du namespace
    - to:  # Autoriser PostgreSQL
      - namespaceSelector:
          matchLabels:
            name: databases
```

## Workflow DÃ©veloppeur

```bash
# 1. CrÃ©er un nouveau tenant
mkdir tenant-configs/team-sales
cp tenant-configs/_template/values.yaml tenant-configs/team-sales/

# 2. Personnaliser la configuration
vim tenant-configs/team-sales/values.yaml

# 3. Commit & Push
git add tenant-configs/team-sales/
git commit -m "Add team-sales tenant"
git push origin main

# 4. ArgoCD dÃ©tecte le changement (30s max)
# â†’ CrÃ©e Application ArgoCD automatiquement
# â†’ DÃ©ploie Dagster dans namespace dagster-team-sales
# â†’ ~3min plus tard: tenant opÃ©rationnel âœ…
```

## MÃ©triques de Performance

### Avant l'Architecture GitOps

- DÃ©ploiement manuel : **2 heures**
- Provisioning tenant : Intervention humaine requise
- Taux de dÃ©ploiement : 5-10 par semaine
- Rollback : Complexe, risquÃ©

### AprÃ¨s l'Architecture GitOps

- DÃ©ploiement automatique : **5 minutes**
- Provisioning tenant : ZÃ©ro intervention
- Taux de dÃ©ploiement : 50+ par jour
- Rollback : Simple, instantanÃ© (git revert)

**Statistiques ClÃ©s:**
- 5 tenants actifs
- 99.5% de dÃ©ploiements rÃ©ussis
- Temps moyen de rollback : 45 secondes

## Related Cloud Native Articles

- [Helm Chart Visualization Tool](/articles/helm-chart-visualization-tool) - MaÃ®triser les dÃ©pendances Helm
- [Edge Computing with Jetson Xavier](/articles/edge-computing-docker-jetson-xavier) - Optimisation Docker pour ARM64

## Technologies ClÃ©s

- **ArgoCD** : Synchronisation Git â†’ Kubernetes
- **Helm** : Templating de charts
- **Kubernetes** : Orchestration
- **Mustache** : Templating dynamique
- **Git** : Source de vÃ©ritÃ©

## Lessons Learned

1. **Automatisation totale** : Moins de tÃ¢ches manuelles = moins d'erreurs
2. **Isolation par dÃ©faut** : SÃ©curitÃ© intÃ©grÃ©e, pas ajoutÃ©e aprÃ¨s coup
3. **Configuration as Code** : TraÃ§abilitÃ© et reproductibilitÃ©

## Conclusion

Cette architecture GitOps n'est pas qu'une solution technique. C'est une transformation culturelle : dÃ©ployer devient un acte de configuration, pas d'intervention.

<ViewRepository url="https://github.com/slamer59/dagster-argocd-configuration" text="Voir le projet sur GitHub" />

---

**Explorez tous mes projets Cloud Native â†’** [Cloud Native & DevOps Hub](/articles/cloud-native-devops-expertise)
